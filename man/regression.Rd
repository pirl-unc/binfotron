% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/regression.R
\name{regression}
\alias{regression}
\title{performs the specified regression on the data}
\usage{
regression(
  input_dt,
  indep_list,
  base_file_name = "regression_output",
  clear_readme = TRUE,
  combined_group_name = "All",
  dep_vars = NULL,
  dep_var_families = NULL,
  event_clm = "OS_e",
  fdr_method = NULL,
  inclusion_list = list(),
  model_comparison_list = NULL,
  model_function = function(dep_var = "", indep_vars = "NULL") {
     paste0("glm(",
    dep_var, " ~ ", paste0("`", indep_vars, "`", collapse = " + "),
    ", data = model_dt)")
 },
  my_grouping = NULL,
  output_dir = ".",
  sample_clm = get_default_sample_key(),
  save_models = FALSE,
  time_clm = "OS_d",
  write_files = TRUE,
  include_dep_var_in_prediction_name = FALSE
)
}
\arguments{
\item{input_dt}{A data.table that includes all columns of data needed to do the 
analysis:  \code{names(indep_list)}, dep_vars (for glm), \code{names(inclusion_list)},
event_clm & time_clm (for coxph), \code{names(unique(unlist(model_comparison_list))},
and my_grouping.}

\item{indep_list}{Required named list of column names to use as the independent 
variable. Names of the list will be used to name the output stats.
Example:  \cr 
\code{my_indep_list = list( # no default \cr 
  TRA_Chao1 = c("TRA_Chao1"), \cr 
  TRB_Chao1 = c("TRB_Chao1"), \cr 
  TCR_Chao1 = c("TRA_Chao1", "TRB_Chao1") \cr 
)}}

\item{base_file_name}{Character string to prefix the names of the output files.}

\item{combined_group_name}{Character string to call the combinded groups catagory.}

\item{dep_vars}{Character vector containing the coumn names. Example: \cr 
\code{codemy_dep_vars = c("Age", "SNV_Log2_Neoantigens", "Indel_Log2_Neoantigens")}}

\item{dep_var_families}{This character vector should contain the names of the 
families to add to the model.  This isn't used for coxph, since the dependent
variable for coxph is survival.  Possible values here should be of the form: 
\code{'Gamma("identity")'} or \code{'gaussian'} and can include anything accepted 
\code{\link{glm}}.}

\item{event_clm}{For coxph.  The name of the column from which to draw the event 
information.  The column should only contain integers of 1 and 0.  If specified, 
this column needs to be present in \code{input_dt}.}

\item{fdr_method}{Deprecated. Multiple PValue columns made this overly complicated. Just use \code{\link{binfotron::calc_fdr}} separately.
\code{stats::p.adjust.methods}.}

\item{inclusion_list}{List to specify the samples that should be kept.
For example \code{list(pathology_T_stage = c('T1', 'T2', 'T3'), is_asian = c(TRUE))} 
would drop samples in which the value for the column named 'pathology_T_stage' 
was not either 'T1', 'T2', or 'T3'. Samples must also have 'is_asian' equal 
to \code{TRUE}.  The names of this list should be column names for \code{input_dt}}

\item{model_comparison_list}{Optional named list of column names that should be used for a 
full and reduced model comparison.  Every group of coulms on this list will be 
run against each dep_vars indep_list combination.  The reduced model will only 
include the items on the list.  The full modle will include the independent 
varible(s) as well.  The names of this list will be what the model comparison 
will be called. The values of this list should be column names in \code{input_dt}.
Example: \cr 
\code{model_comparison_list = list( \cr 
  Age = c("Age"), \cr 
  Tissue = c("Tissue"), \cr 
  Combined = c("Age", "Tissue") \cr 
)}}

\item{model_function}{A function to return the model.  Important to set 
\code{data = model_dt} in the function.  Do not set glm family.  This will be
added based on \code{dep_var_families}. See examples below.
glm example: \cr 
\code{model_function =function(dep_var = "", indep_vars = "NULL"){ \cr 
  paste0("glm(", dep_var, " ~ ",  paste0(indep_vars, collapse = " + "), ", data = model_dt)") \cr   
}} \cr 
coxph example: \cr 
\code{model_function = function(dep_var = "", indep_vars = "NULL"){ \cr 
   paste0("coxph(Surv(", time_clm,", ", event_clm, ") ~ ",  paste0(indep_vars, collapse = " + "), ", data = model_dt)") \cr 
}} \cr}

\item{my_grouping}{This string is the name of the column you want to use to split 
the data into groups. If specified, this column needs to present in \code{input_dt}.}

\item{output_dir}{Path to the output directory. The parent directory to the path must exist.}

\item{sample_clm}{String to indicate the name of the column for sample names. Only used to output predictions.}

\item{save_models}{Boolean on whether you would like to save the models in individual rds files named <base_file_name>_<group_name>_<indep_list_name> .}

\item{time_clm}{For coxph.  The name of the column from which to draw the time 
information.  If specified, this column needs to present in \code{input_dt}.}

\item{write_files}{Boolean on whether you would like to write the output files.}

\item{fdr_by_columns}{Deprecated. Multiple PValue columns made this overly complicated. Just use \code{\link{binfotron::calc_fdr}} separately.}

\item{fdr_by_columns_for_model_comp}{Deprecated. Multiple PValue columns made this overly complicated. Just use \code{\link{binfotron::calc_fdr}} separately.}
}
\value{
List containing several outputs: 
\enumerate{
  \item stats - data.table with the results of the model output
  \item model_comp - data.table with the full vs reduced model comparisons if \code{model_comparison_list} is provided 
  \item readme - An output of the comparisons made.
}
}
\description{
The purpose of \code{regression} is to perform a regression on the data 
across the range of independant and dependant variables provided.  If m
}
\details{
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
regression
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


This function utilizes one of either \code{\link{glm}} or \code{\link{coxph}} methods.
}
\section{Writes}{

\itemize{
  \item stats file 
  \item model_comp file if \code{model_comparison_list} is provided.
}
}

\section{Todos}{

\itemize{
  \item Support GAMLSS and ability to determine its own family??
  \item Stats output sometimes has blank lines in it
}
}

\section{Limitations}{

\itemize{
  \item Haven't fixed to run with ordinals. 
  \item Haven't tried models with interactions with it yet
}
}

\concept{model}
